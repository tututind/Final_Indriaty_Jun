"0","# Clean up the URI column to extract the station IDs"
"0","stations <- stations %>%"
"0","  mutate(station_id = gsub(""http://irail.be/stations/NMBS/"", """", URI))"
"0",""
"0","threshold <- 3 # Moderate threshold capturing higher-demand OD pairs"
"0",""
"0","# Filter high-occupancy OD pairs"
"0","high_routes <- high_occupancy %>%"
"0","  filter(n >= threshold) %>%"
"0","  left_join(stations, by = c(""from"" = ""station_id"")) %>%"
"0","  rename(from_lon = longitude, from_lat = latitude, from_name = name) %>%"
"0","  left_join(stations, by = c(""to"" = ""station_id"")) %>%"
"0","  rename(to_lon = longitude, to_lat = latitude, to_name = name)"
"0",""
"0","# Create line data for leaflet polylines"
"0","high_routes <- high_routes %>%"
"0","  mutate(route_label = paste(from_name, ""->"", to_name))"
"0",""
"0","# Step 4: Create line data for leaflet polylines"
"0","routes_lines <- high_routes %>%"
"0","  rowwise() %>%"
"0","  do({"
"0","    data.frame("
"0","      lng = c(.$from_lon, .$to_lon),"
"0","      lat = c(.$from_lat, .$to_lat),"
"0","      route_label = .$route_label"
"0","    )"
"0","  })"
"0",""
